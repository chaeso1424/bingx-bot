<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <title>로그 보기</title>
  <style>
    body { font-family: monospace; margin:0; background:#0b0f14; color:#cdd9e5; }
    .topbar { display:flex; justify-content:space-between; align-items:center;
              background:#111921; color:#fff; padding:10px 16px; }
    .btn { background:#2b6cb0; color:#fff; padding:6px 12px; border-radius:4px; text-decoration:none; }
    #logbox { white-space:pre-wrap; background:#0e1621; padding:12px; height:80vh; overflow:auto; }
  </style>
</head>
<body>
  <header class="topbar">
    <div>📜 실시간 로그</div>
    <a href="/" class="btn">← 대시보드</a>
  </header>

  <pre id="logbox"></pre>

  <script>
    const logbox = document.getElementById('logbox');

    function atBottom() {
      return (logbox.scrollTop + logbox.clientHeight) >= (logbox.scrollHeight - 4);
    }

    async function refreshLogs() {
      try {
        const res = await fetch('/logs/text?ts=' + Date.now(), {cache:'no-store'});
        const text = await res.text();
        const wasBottom = atBottom();
        logbox.textContent = text;
        if (wasBottom) logbox.scrollTop = logbox.scrollHeight;
      } catch (e) {
        console.error('log fetch error', e);
      }
    }

    // 1.5초마다 자동 갱신
    setInterval(refreshLogs, 1500);
    refreshLogs();
  </script>
</body>
</html>
